# OWASP ASVS 4.0 — V14 (Configuration) preset
#
# This ruleset covers the response-header requirements from ASVS V14.4 and
# V14.5 that can be validated by inspecting HTTP response headers.
#
# Excluded requirements (not observable via response headers):
#   V14.4.1 — Content-Type charset is context-specific (JSON is always UTF-8 per RFC 8259)
#   V14.4.2 — Content-Disposition: attachment is API-specific; false positives on HTML pages
#   V14.5.1 / V14.5.2 / V14.5.4 — Server-side request validation; not observable in response headers

# V14.4.3 — CSP must be present; unsafe-inline and unsafe-eval are forbidden;
#            default-src must be 'none' or 'self'
Content-Security-Policy:
    Required: True
    Severity: high
    Must-Avoid:
        - unsafe-inline
        - unsafe-eval
    Directives:
        default-src:
            Required: True
            Value-One-Of:
                - none
                - self
        frame-ancestors:
            Required: Optional
            Value-One-Of:
                - none
                - self

# V14.4.4 — X-Content-Type-Options must be nosniff
X-Content-Type-Options:
    Required: True
    Severity: medium
    Value: nosniff

# V14.4.5 — HSTS required with includeSubDomains; max-age >= 15724800 (182 days)
Strict-Transport-Security:
    Required: True
    Severity: high
    Must-Contain:
        - includeSubDomains
    Directives:
        max-age:
            Required: True
            Severity: high
            Value-Gte: 15724800

# V14.4.6 — Referrer-Policy must be one of these privacy-preserving values
Referrer-Policy:
    Required: True
    Severity: medium
    Value-One-Of:
        - strict-origin
        - strict-origin-when-cross-origin
        - no-referrer

# V14.4.7 — X-Frame-Options must be DENY or SAMEORIGIN
X-Frame-Options:
    Required: True
    Severity: medium
    Value-One-Of:
        - DENY
        - SAMEORIGIN

# V14.5.3 — If Access-Control-Allow-Origin is present it must not be * or null
Access-Control-Allow-Origin:
    Required: Optional
    Severity: high
    Must-Avoid:
        - "*"
        - "null"
